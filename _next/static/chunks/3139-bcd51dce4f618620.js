"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3139],{4945:(e,t,a)=>{a.d(t,{Ah:()=>h,Al:()=>F,h1:()=>R});var l=a(46045),r=a(16690),i=a(67768),n=a(74359),o=a(19596),u=a(44630),s=a(17195),d=a(16206),c=a(48011),p=a(82495),m=a(14232),f=a(29394),v=a(63540);let I=e=>{let t=e.bopusQuantity,a=e.sthQuantity,l=e.nddQuantity,r=e.sddQuantity;return t?v.Mf.STOREORDER:l?v.Mf.NEXTDAY:a?v.Mf.ONLINEORDER:r?v.Mf.SAMEDAY:void 0},y=(e,t)=>{var a;let l=null==t||null==(a=t.find(t=>t.skuId===e.skuId))?void 0:a.availabilityInfoVO;l&&Object.keys(l).forEach(e=>{l[e]||delete l[e]});let r=l&&I(l);return{isAvailable:!!l&&Object.values(l).some(e=>e>0),defaultFulfillment:r}};var b=a(76355),g=a(76628),E=a(10159),T=a(89445),k=a(32704);let _=e=>e,A=e=>e,L=async(e,t)=>{let{offset:a,limit:l=p.bt}=e,r=await (0,u.p)(t).get(p.Sb,{params:{offset:a,limit:l}});if(r.status>=400)throw Error("Error fetching saved for later items: ".concat(r.statusText));return _(r.data)},S=(e,t)=>null==t?void 0:t.map(t=>{let a=e&&y(t,e);return(0,r._)((0,l._)({},t),{available:a})}),N=async(e,t)=>{let a=await (0,u.p)(t).get("".concat(p.Sb,"?offset=").concat(e,"&limit=").concat(25));return A((0,r._)((0,l._)({},a.data),{offset:e}))},h=()=>{var e,t,a;let{sflEnabled:o}=(0,E.y)(),u=(0,i.jE)(),f=(0,c.d4)(e=>e.appData.userAuthenticated),v=(0,b.U)(e=>e.breakpoints.up("lg")),[I,y]=(0,m.useState)(1),[g]=(0,T.QN)("saveForLater"),_=o&&f&&v&&!!(null==g?void 0:g.sflGetEnabled),A=e=>{y(e)},S={offset:I,limit:p.bt},N=(0,n.I)({queryKey:[p.lH.savedForLaterItems,I],queryFn:()=>L(S),enabled:_}),h=null!=(a=N.data)?a:{lineItems:[],lineItemQuantity:0,orderId:""};(0,k.U)(N,e=>{s.A.error({message:"Error fetching saved for later items",meta:{error:(0,d.F)(e)?e.response:e}})});let{mergedItems:F}=O({skuIds:(null==h||null==(e=h.lineItems)?void 0:e.length)>0?null==(t=h.lineItems)?void 0:t.map(e=>e.skuId):[],lineItems:h.lineItems}),R=(0,r._)((0,l._)({},h),{lineItems:F});return(0,m.useEffect)(()=>{if(I<Math.ceil(h.lineItemQuantity/p.bt)){let e=I+1;u.prefetchQuery({queryKey:[p.lH.savedForLaterItems,e],queryFn:()=>L({offset:e,limit:p.bt})})}},[u,I,h.lineItemQuantity]),(0,m.useEffect)(()=>{h.lineItemQuantity>0&&I>Math.ceil(h.lineItemQuantity/p.bt)&&I>1&&A(I-1)},[I,h.lineItemQuantity]),{sflItems:R,sflCurrentPage:I,handleSFLPageChange:A}},F=()=>{var e;let t=(0,c.d4)(e=>e.appData.userAuthenticated),a=(0,b.U)(e=>e.breakpoints.down("md")),{sflEnabled:i,setErrorNotificationData:n}=(0,E.y)(),[u]=(0,T.QN)("saveForLater"),f=t&&i&&a&&!!(null==u?void 0:u.sflGetEnabled),{data:v={pages:[],pageParams:[]},fetchNextPage:I,hasNextPage:y,fetchPreviousPage:g,hasPreviousPage:k,isFetching:_,isPending:A,refetch:L,isError:S,error:h}=(0,o.q)({queryKey:[p.lH.infiniteSavedForLaterItems],queryFn:e=>{let{pageParam:t}=e;return N(t)},getNextPageParam:e=>e.lineItemQuantity>25*e.offset?e.offset+1:void 0,initialPageParam:1,enabled:f});(0,m.useEffect)(()=>{S&&(n("error-fetch","fetch"),s.A.error({message:"Error fetching saved for later items",meta:{error:(0,d.F)(h)?h.response:h}}))},[S,h]);let F=[];v&&v.pages&&(F=v.pages.flatMap(e=>e.lineItems?e.lineItems.map(e=>e.skuId):[]));let{mergedItems:R}=O({skuIds:null!=F?F:[],lineItems:(null==v||null==(e=v.pages)?void 0:e.flatMap(e=>e.lineItems))||[]});return{sflPages:v?(0,r._)((0,l._)({},v),{pages:v.pages.map(e=>(0,r._)((0,l._)({},e),{lineItems:F.length?R:[]}))}):void 0,fetchNextPage:I,hasNextPage:y,fetchPreviousPage:g,hasPreviousPage:k,isFetchingSflPage:_,isPendingSflPage:A,refetchSFLInfinite:L}},R=()=>{var e,t,a;let l=(0,b.U)(e=>e.breakpoints.down("md")),r=h().sflItems.lineItemQuantity,i=null!=(a=null==(t=F().sflPages)||null==(e=t.pages[0])?void 0:e.lineItemQuantity)?a:0,n=l?i:r,o=(0,g.MW)("label_sfl_of"),u=(0,g.MW)("lbl_saved_items");return{sflTotalItemCount:n,getSavedItemsCountString:e=>{if(!n)return"";if(1===n){let e=u.substring(0,u.length-1);return"".concat(n," ").concat(e)}{if(n>1&&n<=p.bt)return"".concat(n," ").concat(u);let t=1===e?1:(e-1)*p.bt+1,a=e*p.bt>n?n:e*p.bt;return t===n?"".concat(a," ").concat(o," ").concat(n," ").concat(u):"".concat(t," - ").concat(a," ").concat(o," ").concat(n," ").concat(u)}}}},O=e=>{let{skuIds:t,lineItems:a}=e,{data:l}=(0,f.G)({skuIds:t});return{mergedItems:S(l,a)}}},7760:(e,t,a)=>{a.d(t,{B:()=>p});var l=a(44630),r=a(74359),i=a(37149),n=a(43534),o=a(94807);let u="".concat(n.YX,"/ecomm/b2c/order/v2/rewards/eligibility"),s=async()=>d((await (0,l.v)().get(u)).data),d=e=>e,c=e=>["rewardsEligibility",e],p=()=>{var e;let{data:t}=(0,o.po)(),a=null==t?void 0:t.miniCartMap,l=null!=(e=null==a?void 0:a.itemCount)?e:0;return(0,r.I)({gcTime:0,queryKey:c(l),queryFn:()=>s(),placeholderData:i.rX})}},8642:(e,t,a)=>{a.d(t,{P:()=>Y});var l=a(46045),r=a(44630),i=a(43534),n=a(67768),o=a(40097),u=a(82495),s=a(48011),d=a(14232),c=a(73295),p=a(89099),m=a(17195),f=a(16206),v=a(29662),I=a(10159),y=a(4945),b=a(66303),g=a(50513),E=a.n(g),T=a(63540),k=a(3197);let _=e=>{var t,a;let{item:r,cartStatus:i,isAcesEnabled:n}=e,o=T.Mf[r.orderType],u=n?{partGroupId:[r.productInfo.partGroupId],partTerminologyId:[r.productInfo.partTerminologyId]}:{originalPartTypeIdList:[r.productInfo.originalPartType],productRepositoryIdList:[r.productInfo.productId]},s=(0,l._)({customLinkName:"Save for later",eventType:"saveForLater",pageName:null==(t=E().utag_data)?void 0:t.pageName,pageType:null==(a=E().utag_data)?void 0:a.pageType,productBrandList:[r.productInfo.brand],productFulfillmentTypeList:Number(o)===T.Mf.STOREORDER?[T.Mf.STOREORDER]:[T.Mf.ONLINEORDER],productIdList:[r.productInfo.skuId],productPartNumberList:[r.productInfo.partNumber],productPriceList:["".concat(r.lineItemPriceInfo.retailPrice)],productRecommendationTypeList:"Saved for Later",productCartStatus:[i]},u);(0,k.g)(s)};var A=a(94807),L=a(15695),S=a(89445),N=a(76355),h=a(14180),F=a(42199),R=a(72448),O=a(48864),w=a(77432),D=a(87594),Q=a(39273),P=a(51154),M=a(26801);let C="".concat(i.YX,"/ecomm/b2c/order/v2/saved-order"),q="SAVEDORDER",G=e=>e,x=async(e,t)=>{let{acesEnabled:a,acesVehicleAttributes:i,fulfillmentTypeId:n,quantity:o,skuId:u,storeNumber:s,vehicleId:d,orderType:c,productId:p,commerceItemId:m,deleteOrgItem:f}=e,v=(0,l._)({fulfillmentTypeId:n,quantity:o,skuId:u,storeNumber:s,vehicleId:d,orderType:c,productId:p,commerceItemId:m,deleteOrgItem:f},a&&i&&{vehicleAttributes:i});return G((await (0,r.p)(t).post(C,v,{headers:{"Content-Type":"application/json;charset=utf-8"}})).data)},Y=e=>{let{acesEnabled:t}=(0,Q.P)(),a=null==e?void 0:e.openModal,l=null==e?void 0:e.removePart,r=(0,p.useRouter)(),i=(0,n.jE)(),g=(0,s.d4)(e=>e.appData.userAuthenticated),E=c.L.getItem("forgotPasswordFlowCompleted"),[,k]=(0,S.QN)("saveForLater"),C=(0,N.U)(e=>e.breakpoints.down("md"))?u.lH.infiniteSavedForLaterItems:u.lH.savedForLaterItems,{setNotificationData:G,setErrorNotificationData:Y,MAX_SFL_ITEMS:K,SAVE_FOR_LATER_MAX_QUANTITY:V}=(0,I.y)(),W="true"===(0,D.u)("IS_NEW_DEALS_API_ENABLED"),{sflTotalItemCount:X}=(0,y.h1)(),{data:j}=(0,L.V)(),{data:H}=(0,A.po)(),B=null==j?void 0:j.storeNumber,U=null==H?void 0:H.vehicleMap.catalogVehicleId,J=(0,h.w)(),{acesEnabled:Z}=(0,Q.P)(),$=(0,P.l)(),z=(0,M.Y)({engine:null==$?void 0:$.engine,makeName:null==$?void 0:$.make,modelName:null==$?void 0:$.model,regionName:null==$?void 0:$.region,subModelName:null==$?void 0:$.subModel}),{mutateAsync:ee}=(0,o.n)({mutationKey:[u.lH.sflMutation,u.lH.addToSavedForLater,{acesEnabled:Z,acesVehicleAttributes:z}],mutationFn:x,onSuccess:async(e,t)=>{let a=(0,v.T4)();return t.deleteOrgItem&&t.commerceItemId&&a&&(await el(a.currentItem,a.skuAvailabilityInfo),await J((0,F.A)(i))),await (null==l?void 0:l({shouldCallLinkTrack:!1})),"true"===E&&r.reload(),c.L.removeItem("forgotPasswordFlowCompleted"),k({sflGetEnabled:!0}),i.invalidateQueries({queryKey:[C]})},onError:e=>{m.A.error({message:"Error adding save for later item",meta:{error:(0,f.F)(e)?e.response:e}})}}),et=(0,d.useCallback)(async e=>{await ee(e)},[ee]),ea=async e=>{let{currentItem:t,itemData:l}=e;if(t&&B&&t.selectedFulfillmentType){let r={orderType:q,skuId:t.skuId,productId:t.productId,quantity:t.itemQuantity,fulfillmentTypeId:t.selectedFulfillmentType.toString(),vehicleId:U,storeNumber:B,skuDisplayName:t.skuDisplayName,acesEnabled:Z,acesVehicleAttributes:z};if(g)if(X>=parseInt(null!=K?K:V))return void Y("warn",t.skuId);else try{await et(r),_({item:l,cartStatus:"Saved for later",isAcesEnabled:Z}),G("to_sfl_list",t.skuId,t.skuDisplayName)}catch(e){return Y("error-to-sfl",t.skuId),Promise.reject(e)}else(0,v.xZ)(e),k({sflGetEnabled:!1}),null==a||a(0,"Save For Later")()}},el=async(e,a)=>{var l,r,n,o,s;let d=null!=(n=null==a||null==(r=a.fulfillmentGroups)||null==(l=r.find(e=>e.selected))?void 0:l.maxAvailableQty)?n:0;if(e){let a={prodSku:null==e?void 0:e.skuId,productFulfillmentType:T.Mf[e.orderType].toString(),originalPartType:e.originalPartType,productRepositoryId:e.productId,brand:e.brand,price:e.price,productAvailableQuantity:d,quantity:1,partGroupId:null!=(o=null==e?void 0:e.partGroupId)?o:"",partTerminologyId:null!=(s=null==e?void 0:e.partTerminologyId)?s:""};(0,b.k)(a,t);let l={skuIds:e.skuId,certonaType:O.Q.removeFromCartEvent};await (0,R.e)(l),i.removeQueries({queryKey:(0,w.mp)({skuIds:[e.skuId],storeNumber:B,vehicleId:U,isNewDealsApiEnabled:W})}),(0,v._t)(u.g5)}},er=async e=>{let{currentItem:t,analyticsData:a,itemData:l}=e;if(t&&B&&t.selectedFulfillmentType){let e={orderType:q,skuId:t.skuId,productId:t.productId,quantity:"1",fulfillmentTypeId:t.selectedFulfillmentType.toString(),vehicleId:U,storeNumber:B,skuDisplayName:t.skuDisplayName,commerceItemId:a.commerceItemId,deleteOrgItem:!0,acesEnabled:Z,acesVehicleAttributes:z};X<parseInt(null!=K?K:V)?(await et(e).catch(()=>(0,v._t)(u.g5)),_({item:l,cartStatus:"Saved for later",isAcesEnabled:Z}),G("to_sfl_list",t.skuId,t.skuDisplayName)):(Y("warn",t.skuId),(0,v._t)(u.g5))}};return(0,d.useEffect)(()=>{(0,v.T4)()||k({sflGetEnabled:!0})},[k]),{onSaveForLaterPress:ea,handleSaveItemOnSignUp:er}}},10159:(e,t,a)=>{a.d(t,{y:()=>i});var l=a(14232),r=a(25713);let i=()=>{let e=(0,l.useContext)(r.M);if(!e)throw Error("useSflNotification must be used within a SFLNotificationProvider");return e}},25713:(e,t,a)=>{a.d(t,{M:()=>l});let l=(0,a(14232).createContext)({sflNotification:{},sflEnabled:!1,sflErrWarning:{},MAX_SFL_ITEMS:void 0,SAVE_FOR_LATER_MAX_QUANTITY:"50",showNotificationSnackbar:{show:!1,message:""},setNotificationData:()=>({}),setErrorNotificationData:()=>({}),clearErrorNotificationData:()=>({}),matchErrorWarningToProductSku:()=>void 0,getSflListWarningErr:()=>void 0,removeWarningsOrErrors:()=>{},getItemNotificationIndex:()=>({idx:-1,skuId:void 0}),replaceListItemWithNotification:()=>{}})},29662:(e,t,a)=>{a.d(t,{T4:()=>i,_t:()=>u,d8:()=>o,xZ:()=>n});var l=a(82114),r=a(82495);let i=()=>{let e=l.s.getItem(r.g5);return e?JSON.parse(e):null},n=e=>{l.s.setItem(r.g5,JSON.stringify(e))},o=e=>{l.s.setItem(r.am,JSON.stringify(e))},u=e=>{l.s.removeItem(e)}},66303:(e,t,a)=>{a.d(t,{k:()=>n});var l=a(46045),r=a(63540),i=a(3197);let n=(e,t)=>{let a=t?{partGroupId:[e.partGroupId],partTerminologyId:[e.partTerminologyId]}:{originalPartTypeIdList:[e.originalPartType],productRepositoryIdList:[e.productRepositoryId]},n=(0,l._)({eventType:"removeFromCart",productIdList:[e.prodSku],productFulfillmentTypeList:Number(e.productFulfillmentType)===r.Mf.STOREORDER?[r.Mf.STOREORDER]:[r.Mf.ONLINEORDER],productBrandList:[e.brand],productPriceList:[e.price],productRequestedQuantityList:[e.quantity]},a);e.productAvailableQuantity&&(n.productAvailableQuantityList=["".concat(e.productAvailableQuantity)]),(0,i.g)(n)}},72448:(e,t,a)=>{a.d(t,{e:()=>n});var l=a(46045),r=a(33507),i=a(35002);async function n(e){var t,a;let n=(0,i.R)(e);window.certona=(0,l._)({device:(0,r.Z)()},n),await (null==(t=(a=window).callCertona)?void 0:t.call(a))}},77432:(e,t,a)=>{a.d(t,{BY:()=>f,Dg:()=>k,Kd:()=>E,mp:()=>T});var l=a(46045),r=a(16690),i=a(43534),n=a(94807),o=a(63248),u=a(44630),s=a(77904),d=a(87594),c=a(85111);let p="".concat(i.YX,"/ecomm/b2c/v3/browse/sku/details"),m="".concat(i.YX,"/ecomm/b2c/browse/v3/skus/price-availability");function f(e){if(!e)return[];let t=e=>({alternateOptionsLabel:e.alternateOptionsLabel,available:e.available,availableLabel:e.availableLabel,availableQty:e.availableQty,estimatedDeliveryDate:e.estimatedDeliveryDate,fulfillmentCutOffTimeMessage:e.fulfillmentCutOffTimeMessage,fulfillmentTypeId:(0,c.$)(e.fulfillmentTypeId)?101:e.fulfillmentTypeId,fulfillmentTypeIdOriginal:e.fulfillmentTypeId,fulfillmentTypeLabel:e.fulfillmentTypeLabel,fullfillmentCutOffDate:e.fullfillmentCutOffDate,groupId:e.groupTypeId,groupLabel:e.displayLabel,selected:e.selected,sisterStoreAvailable:e.sisterStoreAvailable,dealsAvailableQty:e.dealsAvailableQty,numberOfSisterStoreAvailable:e.numberOfSisterStoreAvailable}),a={};return e.forEach(e=>{a[e.groupTypeId]?(a[e.groupTypeId].groupFulfillmentOptions.push(t(e)),e.available&&!a[e.groupTypeId].available&&(a[e.groupTypeId].available=e.available),e.selected&&!a[e.groupTypeId].selected&&(a[e.groupTypeId].selected=e.selected),e.availableQty>a[e.groupTypeId].maxAvailableQty&&(a[e.groupTypeId].maxAvailableQty=e.availableQty)):a[e.groupTypeId]={groupId:e.groupTypeId,groupLabel:e.displayLabel,groupFulfillmentOptions:[t(e)],selected:e.selected,available:e.available,maxAvailableQty:e.availableQty||0}}),Object.values(a).sort((e,t)=>t.groupId-e.groupId)}let v=e=>e.map(e=>{var t;let a=null!=(t=e.skuPricingAndAvailability.skuAvailabilityInfo.defaultFulfillmentGroupId)?t:"",i=f(e.skuPricingAndAvailability.skuAvailabilityInfo.fulfillmentOptions);return(0,r._)((0,l._)({defaultFulfillmentGroupId:a,fulfillmentOptions:i},e),{skuPricingAndAvailability:(0,r._)((0,l._)({},e.skuPricingAndAvailability),{skuAvailabilityInfo:(0,r._)((0,l._)({},e.skuPricingAndAvailability.skuAvailabilityInfo),{fulfillmentOptions:e.skuPricingAndAvailability.skuAvailabilityInfo.fulfillmentOptions.map(e=>(0,r._)((0,l._)({},e),{fulfillmentTypeId:(0,c.$)(e.fulfillmentTypeId)?101:e.fulfillmentTypeId}))})})})}),I=async(e,t)=>{let{skuIds:a,isNewDealsApiEnabled:l=!1}=e;if(!a)throw Error("skuIds is required");return v((await (0,u.p)(t).get("".concat(l?m:p,"/").concat(a.join(",")))).data)},{useData:y,prefetch:b,query:g}=(0,s.V)("productSkuDetails",I),E=e=>{var t,a;let{skuIds:l,enabled:r=!!(null==l?void 0:l.length)}=e,i=(0,n.po)(),u="true"===(0,d.u)("IS_NEW_DEALS_API_ENABLED"),s=null==(t=i.data)?void 0:t.storeNumber,c=null==(a=(0,o.u)(i.data))?void 0:a.catalogVehicleId;return y({enabled:i.isSuccess&&r&&!!l,skuIds:(null==l?void 0:l.length)?l:null,storeNumber:null!=s?s:"",vehicleId:c||"0",isNewDealsApiEnabled:u,gcTime:0})},T=e=>{let{skuIds:t,storeNumber:a,vehicleId:l,isNewDealsApiEnabled:r=!1}=e;return g.getFullKey({skuIds:(null==t?void 0:t.length)?t:null,storeNumber:null!=a?a:"",vehicleId:l||"0",isNewDealsApiEnabled:r})},k=(e,t)=>e.getQueryData(T(t))},82495:(e,t,a)=>{a.d(t,{Sb:()=>r,am:()=>u,bt:()=>n,g5:()=>o,lH:()=>i});var l=a(43534);let r="".concat(l.YX,"/ecomm/b2c/order/v2/saved-order"),i={savedForLaterItems:"savedForLaterItems",infiniteSavedForLaterItems:"savedForLaterInfinite",sflMutation:"sflMutation",deleteSFLItem:"deleteSFLItem",addToSavedForLater:"addToSavedForLater",addSflToCart:"addSflToCart"},n=6,o="savedForLaterItem",u="sflNotification"},84363:(e,t,a)=>{a.d(t,{k:()=>r});var l=a(66226);function r(e,t){var a;return e?(a=(0,l.v)(e,t).message,/Exception|{/.test(a)?"label_login_messages_GENERIC_SERVER_ERROR":a):"label_login_messages_GENERIC_SERVER_ERROR"}}}]);
//# sourceMappingURL=3139-bcd51dce4f618620.js.map