"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6712],{1619:(e,t,n)=>{n.d(t,{E:()=>l});let l={src:"/images/down-arrow.svg",alt:""}},56712:(e,t,n)=>{n.r(t),n.d(t,{MyAccount:()=>T});var l=n(37876),s=n(14232),i=n(58103),r=n.n(i),a=n(89099),c=n(84139),d=n(44331),o=n(30093),u=n(18493),h=n(12541),m=n(83589),x=n(24497),g=n(64029),j=n.n(g),y=n(45508),p=n(48011),v=n(17195),S=n(67768),f=n(86537),E=n(502),b=n(96952),w=n(14180),_=n(86113),I=n(36183),A=n(78795),k=n(54594),L=n(1619);let N="22px";function C(e){var t;let{textVariant:n,greeting:s,userFirstName:i,exclaimed:r,isUS:a,isFetchingProfile:c}=e,d=null!=(t=null==i?void 0:i.toLowerCase())?t:"",u="".concat(null==d?void 0:d.slice(0,20)).concat(d&&d.length>20?"â€¦":"").split(" ");for(let e=0;e<u.length;e++)u[e]=u[e].charAt(0).toUpperCase()+u[e].slice(1);let h=u.join(" ");return i?(0,l.jsxs)(A.E,{variant:n,maxLines:1,attributes:{style:{lineHeight:N}},children:[r&&!a?"\xa1":"",null!=s?s:(0,l.jsx)(o.J,{label:"label_myAccount_greeting"})," ".concat(h).concat(r?"!":"")]}):c?(0,l.jsx)("div",{style:{height:N}}):null}var M=n(89481),B=n(15227),F=n(3634),H=n(73295),K=n(24210);let T=e=>{var t,n;let{handleClose:i,isFixedHeader:g,setShowSignInAlert:N}=e,T=(0,s.useRef)(null),P=(0,s.useRef)(null),J=(0,u.Y)(),O=(0,a.useRouter)(),R=(0,w.w)(),U=(0,S.jE)(),{isAlertBannerVisible:G}=(0,K.h)(),{data:V}=(0,E.b)(),{userAuthenticated:D}=(0,p.d4)(e=>{let{appData:t}=e;return t}),W=(null!=(n=null==V||null==(t=V.loyaltyAccount)?void 0:t.rewardBalance)?n:0).toFixed(2),[X,$]=(0,s.useState)(!1),[z,Y]=(0,s.useState)(!1),[q,Q]=(0,s.useState)(!1),[Z,ee]=(0,s.useState)(!1),[et,en]=(0,s.useState)(!1),[el,es]=(0,s.useState)(!1),{data:ei,isFetching:er}=(0,_.je)(),{resetSignInFlowTypeContextFn:ea}=(0,s.useContext)(B.G);(0,s.useEffect)(()=>{let e=document.getElementById("myAccountLink");return e&&(e.addEventListener("mouseenter",ec),e.addEventListener("mouseleave",ed)),()=>{e&&(e.removeEventListener("mouseenter",ec),e.removeEventListener("mouseleave",ed))}});let ec=()=>$(!0),ed=()=>$(!1),eo=(0,s.useCallback)(()=>{Q(!1),null==N||N(!0),i&&i()},[i,N]),eu=(0,s.useCallback)(()=>{q&&!el&&(Q(!1),null==N||N(!0))},[el,q,N]),eh=(0,s.useCallback)(e=>{q&&e.stopImmediatePropagation(),(e.keyCode||e.which)===x.K.escKeyCode&&q&&(eo(),en(!0))},[eo,q]),em=e=>{e.code===x.K.spaceKeyTypeString&&e.preventDefault()};(0,s.useEffect)(()=>{let e=null==T?void 0:T.current;return null==e||e.addEventListener("keypress",em,!1),()=>{null==e||e.removeEventListener("keypress",em,!1)}}),(0,s.useEffect)(()=>{let e=document.getElementById("non-sticky-header");return e&&q&&e.addEventListener("click",()=>Q(!1)),()=>{null==e||e.removeEventListener("click",()=>Q(!1))}},[q]);let ex=(0,s.useCallback)(()=>{var e,t;let n=document.getElementById("topHeaderWrapper"),l=document.getElementById("fixedHeaderWrapper"),s=document.getElementById("header-promo");null==T||null==(e=T.current)||e.addEventListener("mouseleave",function(){null==n||n.addEventListener("mousedown",eu),null==l||l.addEventListener("mousedown",eu),null==s||s.addEventListener("mousedown",eu)},!1),null==T||null==(t=T.current)||t.addEventListener("mouseover",function(){null==n||n.removeEventListener("mousedown",eu),null==l||l.removeEventListener("mousedown",eu),null==s||s.removeEventListener("mousedown",eu)},!1)},[eu]);(0,s.useEffect)(()=>(ex(),document.addEventListener("keydown",eh,!1),()=>{document.removeEventListener("keydown",eh,!1)}),[eh,ex,q]),(0,s.useEffect)(()=>{et&&ev()},[et,q]);let eg=()=>{D||(0,f.TV)("loginInteractionMethod","Header")},ej=async()=>{let e=H.L.getItem("loginInteractionMethod");D&&ee(!0);try{await R((0,b.kG)(!1)),await R((0,y.S)(U)),ea(),Q(!1),null==N||N(!0),ee(!1),e&&H.L.removeItem("loginInteractionMethod"),O.push("/")}catch(e){ee(!1),Y(!0),Q(!0),v.A.error({meta:e,message:"Error in Sign Out inside MyAccount"})}null==i||i()},ey=()=>{Q(!q),null==N||N(q)},ep=()=>{eo(),ej()},ev=()=>{var e;return null==(e=P.current)?void 0:e.focus()},eS=J!==h.Ns.mx;return(0,l.jsxs)("div",{className:j().myAccountContainer,"data-test":"component-MyAccount",ref:T,onKeyDown:e=>{var t,n,l;let s=e.currentTarget,i=T.current,r=e.key===x.K.enterKeyType,a=e.key===x.K.tabKeyType,c=e.key===x.K.spaceKeyType,d=document.getElementById("dropdown-menu-items"),o=null==d||null==(t=d.lastElementChild)?void 0:t.lastElementChild,u=!D&&((null==d?void 0:d.lastElementChild)===document.activeElement||(null==o?void 0:o.contains(document.activeElement))),h=D&&a&&(null==d||null==(l=d.children[4])||null==(n=l.lastElementChild)?void 0:n.contains(document.activeElement)),m=a&&!1===e.shiftKey&&(u||h);s===i&&(r||c)&&!q&&(Q(!0),null==N||N(!1),eg()),m&&(Q(!1),null==N||N(!0))},children:[(0,l.jsxs)(d.A,{only:["sm"],children:[(0,l.jsx)("div",{ref:P,onClick:e=>{eg(),"A"!==e.currentTarget.tagName&&ey()},"data-test":"toggle-button","aria-haspopup":"true","aria-expanded":q,tabIndex:0,role:"button",children:g?(0,l.jsx)("div",{"data-testid":"stickyHeaderId",role:"button",children:(0,l.jsxs)(I.S,{direction:"row",align:"center",padding:2,wrap:!1,children:[(0,l.jsx)(I.S.Item,{children:(0,l.jsxs)(I.S,{justify:"center",align:"center",direction:"column",height:"100%",children:[D?(0,l.jsx)(I.S.Item,{children:(0,l.jsx)(I.S,{height:"24px",width:"24px",align:"center",justify:"center",children:(0,l.jsx)("img",{src:"/images/avatar.svg",alt:"",width:24,height:24,decoding:"async"})})}):(0,l.jsx)(I.S.Item,{children:(0,l.jsxs)(I.S,{direction:"row",align:"end",children:[(0,l.jsx)(I.S.Item,{children:(0,l.jsx)(I.S,{align:"center",justify:"center",className:r()(j().userIconSticky),attributes:{id:"myAccountUserIconSticky"},children:(0,l.jsx)(k.Ay,{src:"/images/signin.svg",alt:"",width:16.67,height:16.67})})}),(0,l.jsx)(I.S.Item,{gapBefore:1,children:(0,l.jsx)(I.S,{padding:[1,0],height:"100%",justify:"0.00"!==W?"center":"end",children:(0,l.jsx)(I.S.Item,{children:(0,l.jsx)(k.Ay,{width:12,height:8,src:L.E.src,alt:L.E.alt,"data-testid":"at_arrow_sign_in_icon"})})})})]})}),D?null:(0,l.jsx)(I.S.Item,{attributes:{"data-test":"noauth-content"},children:(0,l.jsx)(A.E,{variant:"subtitle-regular",children:(0,l.jsx)(o.J,{label:"mf_homepage_header_signin"})})})]})}),(0,l.jsx)(I.S.Item,{children:(0,l.jsx)(I.S,{padding:D?[0,2]:0,children:D?(0,l.jsx)(I.S.Item,{children:(0,l.jsxs)(I.S,{direction:"column",attributes:{id:"at_user_name_icon"},children:[(0,l.jsx)(I.S.Item,{attributes:{"data-testid":"auth-content","data-test":"auth-content"},children:(0,l.jsx)(C,{textVariant:"small-body",userFirstName:null==ei?void 0:ei.firstName,isFetchingProfile:er})}),eS?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(I.S,{height:"2px"}),"0.00"!==W?(0,l.jsx)(I.S.Item,{attributes:{"data-testid":"at_user_rewards_link"},children:(0,l.jsxs)(A.E,{className:j().rewardsBalance,variant:"subtitle-bold",attributes:{style:{lineHeight:"20px"}},children:[(0,l.jsx)(o.J,{label:"label_MyAccountMyProfile_landing_Rewards"}),": $".concat(W)]})}):(0,l.jsx)(I.S.Item,{children:(0,l.jsx)(A.E,{variant:"subtitle-bold",attributes:{style:{lineHeight:"20px"}},children:(0,l.jsx)(o.J,{label:"label_myAccount_account"})})})]}):null]})}):null})}),D?(0,l.jsx)(I.S.Item,{children:(0,l.jsx)(I.S,{padding:[1,0],height:"100%",justify:"0.00"!==W?"center":"end",children:(0,l.jsx)(I.S.Item,{children:(0,l.jsx)("img",{width:11,height:6,src:L.E.src,alt:L.E.alt,"data-testid":"at_arrow_sign_in_icon",decoding:"async"})})})}):null]})}):(0,l.jsxs)(I.S,{direction:"row",align:"center",padding:[2,2],children:[(0,l.jsx)(I.S.Item,{children:D?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(I.S,{justify:"center",align:"center",direction:"column",height:"100%",children:(0,l.jsx)(I.S.Item,{children:(0,l.jsx)(I.S,{height:"24px",width:"24px",align:"center",justify:"center",children:(0,l.jsx)("img",{src:"/images/avatar.svg",alt:"",width:24,height:24,decoding:"async"})})})})}):(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(I.S,{justify:"center",align:"center",direction:"column",height:"100%",padding:[0,2],children:(0,l.jsx)(I.S.Item,{children:(0,l.jsxs)(I.S,{align:"center",justify:"center",className:r()(j().userIcon,j().userIconSticky),attributes:{id:"myAccountUserIcon"},children:[(0,l.jsx)(F.b,{}),(0,l.jsx)(I.S.Item,{attributes:{"data-test":"noauth-content"},className:j().label,children:(0,l.jsx)(A.E,{variant:"subtitle-regular",children:(0,l.jsx)(o.J,{label:"mf_homepage_header_signin"})})})]})})})})}),D?(0,l.jsx)(I.S.Item,{children:(0,l.jsx)(I.S,{padding:[0,2],children:(0,l.jsx)(I.S.Item,{children:(0,l.jsxs)(I.S,{direction:"column",attributes:{id:"at_user_name_icon"},children:[(0,l.jsx)(I.S.Item,{attributes:{"data-testid":"auth-content","data-test":"auth-content"},children:(0,l.jsx)(C,{textVariant:"small-body",userFirstName:null==ei?void 0:ei.firstName,isFetchingProfile:er})}),eS?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(I.S,{height:"2px"}),"0.00"!==W?(0,l.jsx)(I.S.Item,{attributes:{"data-testid":"at_user_rewards_link"},children:(0,l.jsxs)(A.E,{className:j().rewardsBalance,variant:"subtitle-bold",attributes:{style:{lineHeight:"20px"}},children:[(0,l.jsx)(o.J,{label:"label_MyAccountMyProfile_landing_Rewards"}),": $".concat(W)]})}):(0,l.jsx)(I.S.Item,{children:(0,l.jsx)(A.E,{variant:"subtitle-bold",attributes:{style:{lineHeight:"20px"}},children:(0,l.jsx)(o.J,{label:"label_myAccount_account"})})})]}):null]})})})}):null,(0,l.jsx)(I.S.Item,{children:(0,l.jsx)(I.S,{padding:[1,0],height:"100%",justify:"0.00"===W&&D?"end":"center",children:(0,l.jsx)(I.S.Item,{children:(0,l.jsx)("img",{width:D?11:12,height:D?6:8,className:j().arrow,src:L.E.src,alt:L.E.alt,"data-testid":"at_arrow_sign_in_icon",decoding:"async"})})})})]})}),q?(0,l.jsx)("div",{className:r()({[j().popupArrowAuthenticated]:D,[j().popupArrow]:!D,[j().accountPopupArrowGray]:X,[j().accountPopupUserAuthenticated]:D,[j().accountPopup]:!D,[J!==h.Ns.mx?j().topHeaderOffset:j().topHeaderOffsetMX]:D&&!g,[J!==h.Ns.mx?j().fixedHeaderOffset:j().fixedHeaderOffsetMX]:D&&g}),"data-testid":"dropdown-menu-items",id:"dropdown-menu-items",children:(0,l.jsx)(M.c,{userAuthenticated:D,userFirstName:null==ei?void 0:ei.firstName,userType:null==ei?void 0:ei.userType,rewardsBalance:W,closeModal:eo,closeModalAndSignOut:ep,showErr:z,refocusMyAcctBtn:ev})}):null,(0,l.jsx)(c.z,{id:"backdropComponent",open:q,onClick:()=>{es(!0),Q(!1),null==N||N(!0)},className:r()(j().backdrop,{[j().withAlertBanner]:G})})]}),(0,l.jsx)(d.A,{only:["xl","lg","md"],implementation:"js",children:(0,l.jsx)(M.c,{userAuthenticated:D,userFirstName:null==ei?void 0:ei.firstName,userType:null==ei?void 0:ei.userType,rewardsBalance:W,closeModal:eo,closeModalAndSignOut:ep,showErr:z,refocusMyAcctBtn:ev})}),Z?(0,l.jsx)(m.A,{}):null]})}}}]);
//# sourceMappingURL=6712.b670fbbf29d8b767.js.map